---
id: features
title: Java SDK developer's guide - Features
sidebar_label: Features
sidebar_position: 2
description: The Features section of the Temporal Developer's guide provides basic implementation guidance on how to use many of the development features available to Workflows and Activities in the Temporal Platform.
slug: /dev-guide/java/features
toc_max_heading_level: 4
keywords:
- Java
- developer-guide
- guide-context
- how-to
- java
- sleep
- timers
- workers
tags:
- java
- developer-guide
- guide-context
- how-to
- java
- sleep
- timers
- workers
---

<!-- THIS FILE IS GENERATED. DO NOT EDIT THIS FILE DIRECTLY -->

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

The Features section of the Temporal Developer's guide provides basic implementation guidance on how to use many of the development features available to Workflows and Activities in the Temporal Platform.

In this section you can find the following:

- [How to develop Signals](#signals)
- [How to develop Queries](#queries)
- [How to start a Child Workflow Execution](#child-workflows)
- [How to start a Temporal Cron Job](#temporal-cron-jobs)
- [How to use Continue-As-New](#continue-as-new)
- [How to set Workflow timeouts & retries](#workflow-timeouts)
- [How to set Activity timeouts & retries](#activity-timeouts)
- [How to Heartbeat an Activity](#activity-heartbeats)
- [How to Asynchronously complete an Activity](#asynchronous-activity-completion)
- [How to register Namespaces](#namespaces)
- [How to use custom payload conversion](#custom-payload-conversion)

## How to develop with Signals {#signals}

A [Signal](/workflows#signal) <span id="i-ebeeb30a-2d31-43fa-89ac-b15eaf812ced" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-ebeeb30a-2d31-43fa-89ac-b15eaf812ced" class="preview-modal"><div class="modal-header"><div id="x-ebeeb30a-2d31-43fa-89ac-b15eaf812ced" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#signal">/workflows#signal</a></div><div class="preview-modal-title">What is a Signal?</div><div class="preview-modal-description">A Signal is an asynchronous request to a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/signals">signals</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> is a message sent to a running Workflow Execution.

Signals are defined in your code and handled in your Workflow Definition.
Signals can be sent to Workflow Executions from a Temporal Client or from another Workflow Execution.

### How to define a Signal {#define-signal}

A Signal has a name and can have arguments.

- The name, also called a Signal type, is a string.
- The arguments must be [serializable](/dataconversion#) <span id="i-3d995d22-3caf-4a7c-a862-25da396ddc1e" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-3d995d22-3caf-4a7c-a862-25da396ddc1e" class="preview-modal"><div class="modal-header"><div id="x-3d995d22-3caf-4a7c-a862-25da396ddc1e" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dataconversion#">/dataconversion#</a></div><div class="preview-modal-title">What is a Data Converter?</div><div class="preview-modal-description">A Data Converter is a Temporal SDK component that serializes and encodes data entering and exiting a Temporal Cluster.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>.

The `@SignalMethod` annotation indicates that the method is used to handle and react to external Signals.

```java
@SignalMethod
   void mySignal(String signalName);
```

The method can have parameters that contain the Signal payload and must be serializable by the default Jackson JSON Payload Converter.

```java
void mySignal(String signalName, Object... args);
```

This method does not return a value and must have a `void` return type.

Things to consider when defining Signals:

- Use Workflow object constructors and initialization blocks to initialize the internal data structures if possible.
- Signals might be received by a Workflow before the Workflow method is executed.
  When implementing Signals in scenarios where this can occur, assume that no parts of Workflow code ran.
  In some cases, Signal method implementation might require some initialization to be performed by the Workflow method code firstâ€”for example, when the Signal processing depends on, and is defined by the Workflow input.
  In this case, you can use a flag to determine whether the Workflow method is already triggered; if not, persist the Signal data into a collection for delayed processing by the Workflow method.

### How to handle Signals in an Workflow in Java {#handle-signals}

Workflows listen for Signals by the Signal's name.

Use the `@SignalMethod` annotation to handle Signals in the Workflow interface.

The Signal type defaults to the name of the method. In the following example, the Signal type defaults to `retryNow`.

```java
@WorkflowInterface
public interface FileProcessingWorkflow {

   @WorkflowMethod
   String processFile(Arguments args);

   @SignalMethod
   void retryNow();
}
```

To overwrite this default naming and assign a custom Signal type, use the `@SignalMethod` annotation with the `name` parameter.
In the following example, the Signal type is set to `retrysignal`.

```java
@WorkflowInterface
public interface FileProcessingWorkflow {

   @WorkflowMethod
   String processFile(Arguments args);

   @SignalMethod(name = "retrysignal")
   void retryNow();
}
```

A Workflow interface can define any number of methods annotated with `@SignalMethod`, but the method names or the `name` parameters for each must be unique.

In the following example, we define a Signal method `updateGreeting` to update the greeting in the Workflow.
We set a `Workflow.await` in the Workflow implementation to block the current Workflow Execution until the provided unblock condition is evaluated to `true`.
In this case, the unblocking condition is evaluated to `true` when the Signal to update the greeting is received.

```java
@WorkflowInterface
public interface HelloWorld {
    @WorkflowMethod
    void sayHello(String name);

    @SignalMethod
    void updateGreeting(String greeting);
}
```

```java
public class HelloWorldImpl implements HelloWorld {
    private final Logger workflowLogger = Workflow.getLogger(HelloWorldImpl.class);
    private String greeting;

    @Override
    public void sayHello(String name) {
        int count = 0;
        while (!"Bye".equals(greeting)) {
            String oldGreeting = greeting;
            Workflow.await(() -> !Objects.equals(greeting, oldGreeting));
        }
        workflowLogger.info(++count + ": " + greeting + " " + name + "!");
    }

    @Override
    public void updateGreeting(String greeting) {
        this.greeting = greeting;
    }
}
```

This Workflow completes when the Signal updates the greeting to `Bye`.

**Dynamic Signal Handler**
You can also implement Signal handlers dynamically. This is useful for library-level code and implementation of DSLs.

Use `Workflow.registerListener(Object)` to register an implementation of the `DynamicSignalListener` in the Workflow implementation code.

```java
Workflow.registerListener(
  (DynamicSignalHandler)
      (signalName, encodedArgs) -> name = encodedArgs.get(0, String.class));
```

When registered, any Signals sent to the Workflow without a defined handler will be delivered to the `DynamicSignalHandler`.
Note that you can only register one `Workflow.registerListener(Object)` per Workflow Execution.
`DynamicSignalHandler` can be implemented in both regular and dynamic Workflow implementations.

### How to send a Signal from a Temporal Client {#send-signal-from-client}

When a Signal is sent successfully from the Temporal Client, the [WorkflowExecutionSignaled](/references/events#workflowexecutionsignaled) <span id="i-320e67eb-c8d2-4a5e-ab35-484f28016568" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-320e67eb-c8d2-4a5e-ab35-484f28016568" class="preview-modal"><div class="modal-header"><div id="x-320e67eb-c8d2-4a5e-ab35-484f28016568" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#workflowexecutionsignaled">/references/events#workflowexecutionsignaled</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div> Event appears in the Event History of the Workflow that receives the Signal.

To send a Signal to a Workflow Execution from a Client, call the Signal method, annotated with `@SignalMethod` in the Workflow interface, from the Client code.

In the following Client code example, we start the Workflow `greetCustomer` and call the Signal method `addCustomer` that is handled in the Workflow.

```java
// create a typed Workflow stub for GreetingsWorkflow
GreetingsWorkflow workflow = client.newWorkflowStub(GreetingsWorkflow.class,
        WorkflowOptions.newBuilder()
                // set the Task Queue
                .setTaskQueue(taskQueue)
                // Workflow Id is recommended but not required
                .setWorkflowId(workflowId)
                .build());

// start the Workflow
WorkflowClient.start(workflow::greetCustomer);
// send a Signal to the Workflow
Customer customer = new Customer("John", "Spanish", "john@john.com");
workflow.addCustomer(customer); //addCustomer is the Signal method defined in the greetCustomer Workflow.
```

See [Handle Signals](#handle-signals) <span id="i-5f4715ab-dd07-4aba-ad7f-3104e1438352" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-5f4715ab-dd07-4aba-ad7f-3104e1438352" class="preview-modal"><div class="modal-header"><div id="x-5f4715ab-dd07-4aba-ad7f-3104e1438352" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="#handle-signals">#handle-signals</a></div><div class="preview-modal-title">How to handle Signals in an Workflow in Java</div><div class="preview-modal-description">Use the @SignalMethod annotation to handle Signals within the Workflow interface.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/java">java</a> <a class="preview-modal-tag" href="/tags/developer-guide">developer-guide</a></div></div> for details on how to handle Signals in a Workflow.

### How to send a Signal from a Workflow {#send-signal-from-workflow}

A Workflow can send a Signal to another Workflow, in which case it's called an _External Signal_.

When an External Signal is sent:

- A [SignalExternalWorkflowExecutionInitiated](/references/events#signalexternalworkflowexecutioninitiated) <span id="i-0eab5fde-7a24-46ad-aa24-1cdde08992fc" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-0eab5fde-7a24-46ad-aa24-1cdde08992fc" class="preview-modal"><div class="modal-header"><div id="x-0eab5fde-7a24-46ad-aa24-1cdde08992fc" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#signalexternalworkflowexecutioninitiated">/references/events#signalexternalworkflowexecutioninitiated</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div> Event appears in the sender's Event History.
- A [WorkflowExecutionSignaled](/references/events#workflowexecutionsignaled) <span id="i-0cdccab4-19a6-4917-825d-6d787c87940b" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-0cdccab4-19a6-4917-825d-6d787c87940b" class="preview-modal"><div class="modal-header"><div id="x-0cdccab4-19a6-4917-825d-6d787c87940b" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#workflowexecutionsignaled">/references/events#workflowexecutionsignaled</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div> Event appears in the recipient's Event History.

To send a Signal from within a Workflow to a different Workflow Execution, initiate an `ExternalWorkflowStub` in the implementation of the current Workflow and call the Signal method defined in the other Workflow.

The following example shows how to use an untyped `ExternalWorkflowStub` in the Workflow implementation to send a Signal to another Workflow.

```java
    public String sendGreeting(String name) {

        // initiate ExternalWorkflowStub to call another Workflow by its Id "ReplyWF"
        ExternalWorkflowStub callRespondWorkflow = Workflow.newUntypedExternalWorkflowStub("ReplyWF");

        String responseTrigger = activity.greeting("Hello", name);

        // send a Signal from this sendGreeting Workflow to the other Workflow
        // by calling the Signal method name "getGreetCall" defined in that Workflow.
        callRespondWorkflow.signal("getGreetCall", responseTrigger);

        return responseTrigger;
```

### How to send a Signal-with-Start in Java {#signal-with-start}

Signal-With-Start is used from the Client.
It takes a Workflow Id, Workflow arguments, a Signal name, and Signal arguments.

If there's a Workflow running with the given Workflow Id, it will be signaled. If there isn't, a new Workflow will be started and immediately signaled.

To send Signals to a Workflow Execution whose status is unknown, use `SignalWithStart` with a `WorkflowStub` in the Client code.
This method ensures that if the Workflow Execution is in a closed state, a new Workflow Execution is spawned and the Signal is delivered to the running Workflow Execution.

Note that when the `SignalwithStart` spawns a new Workflow Execution, the Signal is delivered before the call to your `@WorkflowMethod`.
This means that the Signal handler in your Workflow interface code will execute before the `@WorkfowMethod`.
You must ensure that your code logic can deal with this.

In the following example, the Client code uses `SignalwithStart` to send the Signal `setCustomer` to the `UntypedWorkflowStub` named `GreetingWorkflow`.
If the `GreetingWorkflow` Workflow Execution is not running, the `SignalwithStart` starts the Workflow Execution.

```java
...
public static void signalWithStart() {
        // WorkflowStub is a client-side stub to a single Workflow instance
        WorkflowStub untypedWorkflowStub = client.newUntypedWorkflowStub("GreetingWorkflow",
        WorkflowOptions.newBuilder()
                .setWorkflowId(workflowId)
                .setTaskQueue(taskQueue)
                .build());

        untypedWorkflowStub.signalWithStart("setCustomer", new Object[] {customer2}, new Object[] {customer1});

        printWorkflowStatus();

        try {
            String greeting = untypedWorkflowStub.getResult(String.class);
            printWorkflowStatus();
            System.out.println("Greeting: " + greeting);
        } catch(WorkflowFailedException e) {
            System.out.println("Workflow failed: " + e.getCause().getMessage());
            printWorkflowStatus();
        }
    }
...
```

The following example shows the Workflow interface for the `GreetingWorkflow` called in the previous example.

```java
...
@WorkflowInterface
public interface GreetingWorkflow {
    @WorkflowMethod
    String greet(Customer customer);

    @SignalMethod
    void setCustomer(Customer customer);

    @QueryMethod
    Customer getCustomer();
...
}
```

Note that the Signal handler `setCustomer` is executed before the `@WorkflowMethod` `greet` is called.

## How to develop with Queries {#queries}

A [Query](/workflows#query) <span id="i-a6dac6e7-0598-4adc-8a4f-b83771b9fd0d" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-a6dac6e7-0598-4adc-8a4f-b83771b9fd0d" class="preview-modal"><div class="modal-header"><div id="x-a6dac6e7-0598-4adc-8a4f-b83771b9fd0d" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#query">/workflows#query</a></div><div class="preview-modal-title">What is a Query?</div><div class="preview-modal-description">A Query is a synchronous operation that is used to report the state of a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/queries">queries</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> is a synchronous operation that is used to get the state of a Workflow Execution.

### How to define a Query {#define-query}

A Query has a name and can have arguments.

- The name, also called a Query type, is a string.
- The arguments must be [serializable](/dataconversion#) <span id="i-b4048127-da32-4ff5-b4dd-2fbec2572179" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-b4048127-da32-4ff5-b4dd-2fbec2572179" class="preview-modal"><div class="modal-header"><div id="x-b4048127-da32-4ff5-b4dd-2fbec2572179" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dataconversion#">/dataconversion#</a></div><div class="preview-modal-title">What is a Data Converter?</div><div class="preview-modal-description">A Data Converter is a Temporal SDK component that serializes and encodes data entering and exiting a Temporal Cluster.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>.

To define a Query, define the method name and the result type of the Query.

```java
query(String queryType, Class<R> resultClass, Type resultType, Object... args);

  /* @param queryType name of the Query handler. Usually it is a method name.
   * @param resultClass class of the Query result type
   * @param args optional Query arguments
   * @param <R> type of the Query result
  */
```

Query methods can take in any number of input parameters which can be used to limit the data that is returned.

Use the Query method names to send and receive Queries.

Query methods must never change any Workflow state including starting Activities or blocking threads in any way.

### How to handle a Query {#handle-query}

Queries are handled by your Workflow.

Donâ€™t include any logic that causes [Command](/workflows#command) <span id="i-252fb2de-3402-402c-8bd4-70aa23bb30d0" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-252fb2de-3402-402c-8bd4-70aa23bb30d0" class="preview-modal"><div class="modal-header"><div id="x-252fb2de-3402-402c-8bd4-70aa23bb30d0" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#command">/workflows#command</a></div><div class="preview-modal-title">What is a Command?</div><div class="preview-modal-description">A Command is a requested action issued by a Worker to the Temporal Cluster after a Workflow Task Execution completes.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> generation within a Query handler (such as executing Activities).
Including such logic causes unexpected behavior.

To handle a Query in the Workflow, create a Query handler using the `@QueryMethod` annotation in the Workflow interface and define it in the Workflow implementation.

The `@QueryMethod` annotation indicates that the method is used to handle a Query that is sent to the Workflow Execution.
The method can have parameters that can be used to filter data that the Query returns.
Because the method returns a value, it must have a return type that is not `void`.

The Query name defaults to the name of the method.
In the following example, the Query name defaults to `getStatus`.

```java
@WorkflowInterface
public interface FileProcessingWorkflow {
   @QueryMethod
   String getStatus();
}
```

To overwrite this default naming and assign a custom Query name, use the `@QueryMethod` annotation with the `name` parameter. In the following example, the Query name is set to "history".

```java
@WorkflowInterface
public interface FileProcessingWorkflow {
   @QueryMethod(name = "history")
   String getStatus();
}
```

A Workflow Definition interface can define multiple methods annotated with `@QueryMethod`, but the method names or the `name` parameters for each must be unique.

The following Workflow interface has a Query method `getCount()` to handle Queries to this Workflow.

```java
  @WorkflowInterface
  public interface HelloWorld {
    @WorkflowMethod
    void sayHello(String name);

    @QueryMethod
    int getCount();
  }
```

The following example is the Workflow implementation with the Query method defined in the `HelloWorld` Workflow interface from the previous example.

```java
  public static class HelloWorldImpl implements HelloWorld {

    private String greeting = "Hello";
    private int count = 0;

    @Override
    public void sayHello(String name) {
      while (!"Bye".equals(greeting)) {
        logger.info(++count + ": " + greeting + " " + name + "!");
        String oldGreeting = greeting;
        Workflow.await(() -> !Objects.equals(greeting, oldGreeting));
      }
      logger.info(++count + ": " + greeting + " " + name + "!");
    }

    @Override
    public int getCount() {
      return count;
    }
  }
```

**Dynamic Query Handler**
You can also implement Query handlers dynamically. This is useful for library-level code and implementation of DSLs.

Use `Workflow.registerListener(Object)` to register an implementation of the `DynamicQueryListener` in the Workflow implementation code.

```java
Workflow.registerListener(
  (DynamicQueryHandler)
      (queryName, encodedArgs) -> name = encodedArgs.get(0, String.class));
```

When registered, any Queries sent to the Workflow without a defined handler will be delivered to the `DynamicQueryHandler`.
Note that you can only register one `Workflow.registerListener(Object)` per Workflow Execution.
`DynamicQueryHandler` can be implemented in both regular and dynamic Workflow implementations.

### How to send a Query {#send-query}

Queries are sent from a Temporal Client.

To send a Query to a Workflow Execution from an external process, call the Query method (defined in the Workflow) from a `WorkflowStub` within the Client code.

For example, the following Client code calls a Query method `queryGreeting()` defined in the `GreetingWorkflow` Workflow interface.

```java
 // Create our workflow options
    WorkflowOptions workflowOptions =
        WorkflowOptions.newBuilder()
        .setWorkflowId(WORKFLOW_ID)
        .setTaskQueue(TASK_QUEUE).build();

    // Create the Temporal client stub. It is used to start our workflow execution.
    GreetingWorkflow workflow = client.newWorkflowStub(GreetingWorkflow.class, workflowOptions);

    // Start our workflow asynchronously to not use another thread to query.
    WorkflowClient.start(workflow::createGreeting, "World");

    // Query the Workflow to get the current value of greeting and print it.
    System.out.println(workflow.queryGreeting());
```

## Workflow timeouts {#workflow-timeouts}

Each Workflow timeout controls the maximum duration of a different aspect of a Workflow Execution.

Workflow timeouts are set when [starting the Workflow Execution](#workflow-timeouts) <span id="i-047270c8-b01a-4b5d-ab25-633458a9ac23" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-047270c8-b01a-4b5d-ab25-633458a9ac23" class="preview-modal"><div class="modal-header"><div id="x-047270c8-b01a-4b5d-ab25-633458a9ac23" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="#workflow-timeouts">#workflow-timeouts</a></div><div class="preview-modal-title">Workflow timeouts</div><div class="preview-modal-description">Each Workflow timeout controls the maximum duration of a different aspect of a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/guide-context">guide-context</a></div></div>.

- **[Workflow Execution Timeout](/workflows#workflow-execution-timeout) <span id="i-e996d655-64d4-431a-8407-255170f96a49" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-e996d655-64d4-431a-8407-255170f96a49" class="preview-modal"><div class="modal-header"><div id="x-e996d655-64d4-431a-8407-255170f96a49" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#workflow-execution-timeout">/workflows#workflow-execution-timeout</a></div><div class="preview-modal-title">What is a Workflow Execution Timeout?</div><div class="preview-modal-description">A Workflow Execution Timeout is the maximum time that a Workflow Execution can be executing (have an Open status) including retries and any usage of Continue As New.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>** - restricts the maximum amount of time that a single Workflow Execution can be executed.
- **[Workflow Run Timeout](/workflows#workflow-run-timeout) <span id="i-7b523693-75fe-4363-aedd-2af9a7e376bf" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-7b523693-75fe-4363-aedd-2af9a7e376bf" class="preview-modal"><div class="modal-header"><div id="x-7b523693-75fe-4363-aedd-2af9a7e376bf" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#workflow-run-timeout">/workflows#workflow-run-timeout</a></div><div class="preview-modal-title">What is a Workflow Run Timeout?</div><div class="preview-modal-description">This is the maximum amount of time that a single Workflow Run is restricted to.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>**: restricts the maximum amount of time that a single Workflow Run can last.
- **[Workflow Task Timeout](/workflows#workflow-task-timeout) <span id="i-82ee3bc8-b13f-4037-9391-c39e144acb6e" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-82ee3bc8-b13f-4037-9391-c39e144acb6e" class="preview-modal"><div class="modal-header"><div id="x-82ee3bc8-b13f-4037-9391-c39e144acb6e" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#workflow-task-timeout">/workflows#workflow-task-timeout</a></div><div class="preview-modal-title">What is a Workflow Task Timeout?</div><div class="preview-modal-description">A Workflow Task Timeout is the maximum amount of time that the Temporal Server will wait for a Worker to start processing a Workflow Task after the Task has been pulled from the Task Queue.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>**: restricts the maximum amount of time that a Worker can execute a Workflow Task.

Create an instance of [`WorkflowStub`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowStub.html) in the Client code and set your timeout.

Available timeouts are:

- [setWorkflowExecutionTimeout()](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowOptions.Builder.html#setWorkflowExecutionTimeout(java.time.Duration))
- [setWorkflowRunTimeout()](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowOptions.Builder.html#setWorkflowRunTimeout(java.time.Duration))
- [setWorkflowTaskTimeout()](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowOptions.Builder.html#setWorkflowTaskTimeout(java.time.Duration))

```java
//create Workflow stub for YourWorkflowInterface
YourWorkflowInterface workflow1 =
    WorkerGreet.greetclient.newWorkflowStub(
        GreetWorkflowInterface.class,
        WorkflowOptions.newBuilder()
                .setWorkflowId("YourWorkflow")
                .setTaskQueue(WorkerGreet.TASK_QUEUE)
                // Set Workflow Timeout duration
                .setWorkflowExecutionTimeout(Duration.ofSeconds(10))
                // .setWorkflowRunTimeout(Duration.ofSeconds(10))
                // .setWorkflowTaskTimeout(Duration.ofSeconds(10))
                .build());
```

### Workflow retries {#workflow-retries}

A Retry Policy can work in cooperation with the timeouts to provide fine controls to optimize the execution experience.

Use a [Retry Policy](/retry-policies#) <span id="i-3ba13ce6-9c6e-449e-bbaf-0e479fdc111c" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-3ba13ce6-9c6e-449e-bbaf-0e479fdc111c" class="preview-modal"><div class="modal-header"><div id="x-3ba13ce6-9c6e-449e-bbaf-0e479fdc111c" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/retry-policies#">/retry-policies#</a></div><div class="preview-modal-title">What is a Retry Policy?</div><div class="preview-modal-description">A Retry Policy is a collection of attributes that instructs the Temporal Server how to retry a failure of a Workflow Execution or an Activity Task Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> to retry a Workflow Execution in the event of a failure.

Workflow Executions do not retry by default, and Retry Policies should be used with Workflow Executions only in certain situations.

To set a Workflow Retry Options in the [`WorkflowStub`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowStub.html) instance use [`WorkflowOptions.Builder.setWorkflowRetryOptions`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowOptions.Builder.html).

- Type: `RetryOptions`
- Default: `Null` which means no retries will be attempted.

```java
//create Workflow stub for GreetWorkflowInterface
GreetWorkflowInterface workflow1 =
    WorkerGreet.greetclient.newWorkflowStub(
        GreetWorkflowInterface.class,
        WorkflowOptions.newBuilder()
                .setWorkflowId("GreetWF")
                .setTaskQueue(WorkerGreet.TASK_QUEUE)
                // Set Workflow Retry Options
                .setRetryOptions(RetryOptions.newBuilder()
                .build());
```

## How to set Activity timeouts {#activity-timeouts}

Each Activity timeout controls the maximum duration of a different aspect of an Activity Execution.

The following timeouts are available in the Activity Options.

- **[Schedule-To-Close Timeout](/activities#schedule-to-close-timeout) <span id="i-bee6030e-4d42-4b47-a292-f5435ce057f4" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-bee6030e-4d42-4b47-a292-f5435ce057f4" class="preview-modal"><div class="modal-header"><div id="x-bee6030e-4d42-4b47-a292-f5435ce057f4" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#schedule-to-close-timeout">/activities#schedule-to-close-timeout</a></div><div class="preview-modal-title">What is a Schedule-To-Close Timeout?</div><div class="preview-modal-description">A Schedule-To-Close Timeout is the maximum amount of time allowed for the overall Activity Execution, from when the first Activity Task is scheduled to when the last Activity Task, in the chain of Activity Tasks that make up the Activity Execution, reaches a Closed status.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>**: is the maximum amount of time allowed for the overall [Activity Execution](/activities#activity-execution) <span id="i-56046b14-3842-46b6-b621-fb002a02aad1" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-56046b14-3842-46b6-b621-fb002a02aad1" class="preview-modal"><div class="modal-header"><div id="x-56046b14-3842-46b6-b621-fb002a02aad1" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#activity-execution">/activities#activity-execution</a></div><div class="preview-modal-title">What is an Activity Execution?</div><div class="preview-modal-description">An Activity Execution is the full chain of Activity Task Executions.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>.
- **[Start-To-Close Timeout](/activities#start-to-close-timeout) <span id="i-4685eb22-2e61-4d7d-99ad-e9c914c4cc04" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-4685eb22-2e61-4d7d-99ad-e9c914c4cc04" class="preview-modal"><div class="modal-header"><div id="x-4685eb22-2e61-4d7d-99ad-e9c914c4cc04" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#start-to-close-timeout">/activities#start-to-close-timeout</a></div><div class="preview-modal-title">What is a Start-To-Close Timeout?</div><div class="preview-modal-description">A Start-To-Close Timeout is the maximum time allowed for a single Activity Task Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>**: is the maximum time allowed for a single [Activity Task Execution](/workers#activity-task-execution) <span id="i-93c66904-a02d-4209-8d56-7f228c8def3c" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-93c66904-a02d-4209-8d56-7f228c8def3c" class="preview-modal"><div class="modal-header"><div id="x-93c66904-a02d-4209-8d56-7f228c8def3c" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workers#activity-task-execution">/workers#activity-task-execution</a></div><div class="preview-modal-title">What is an Activity Task Execution?</div><div class="preview-modal-description">An Activity Task Execution occurs when a Worker uses the context provided from the Activity Task and executes the Activity Definition.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>.
- **[Schedule-To-Start Timeout](/activities#schedule-to-start-timeout) <span id="i-7be7aa6e-8ed3-4681-b631-76d41b2e40f3" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-7be7aa6e-8ed3-4681-b631-76d41b2e40f3" class="preview-modal"><div class="modal-header"><div id="x-7be7aa6e-8ed3-4681-b631-76d41b2e40f3" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#schedule-to-start-timeout">/activities#schedule-to-start-timeout</a></div><div class="preview-modal-title">What is a Schedule-To-Start Timeout?</div><div class="preview-modal-description">A Schedule-To-Start Timeout is the maximum amount of time that is allowed from when an Activity Task is placed in a Task Queue to when a Worker picks it up from the Task Queue.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>**: is the maximum amount of time that is allowed from when an [Activity Task](/workers#activity-task) <span id="i-9a1242a3-0f23-4881-9a85-f80b651961bb" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-9a1242a3-0f23-4881-9a85-f80b651961bb" class="preview-modal"><div class="modal-header"><div id="x-9a1242a3-0f23-4881-9a85-f80b651961bb" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workers#activity-task">/workers#activity-task</a></div><div class="preview-modal-title">What is an Activity Task?</div><div class="preview-modal-description">An Activity Task contains the context needed to make an Activity Task Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> is scheduled to when a [Worker](/workers#worker) <span id="i-04d127b0-4709-43a8-88ad-6061cf640216" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-04d127b0-4709-43a8-88ad-6061cf640216" class="preview-modal"><div class="modal-header"><div id="x-04d127b0-4709-43a8-88ad-6061cf640216" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workers#worker">/workers#worker</a></div><div class="preview-modal-title">What is a Worker?</div><div class="preview-modal-description">In day-to-day conversations, the term Worker is used to denote both a Worker Program and a Worker Process. Temporal documentation aims to be explicit and differentiate between them.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> starts that Activity Task.

An Activity Execution must have either the Start-To-Close or the Schedule-To-Close Timeout set.

Set your Activity Timeout from the [`ActivityOptions.Builder`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/activity/ActivityOptions.Builder.html) class.

Available timeouts are:

- ScheduleToCloseTimeout()
- ScheduleToStartTimeout()
- StartToCloseTimeout()

You can set Activity Options using an `ActivityStub` within a Workflow implementation, or per-Activity using `WorkflowImplementationOptions` within a Worker.

The following uses `ActivityStub`.

```java
GreetingActivities activities = Workflow.newActivityStub(GreetingActivities.class,
                ActivityOptions.newBuilder()
                        .setScheduleToCloseTimeout(Duration.ofSeconds(5))
                        // .setStartToCloseTimeout(Duration.ofSeconds(2)
                        // .setScheduletoCloseTimeout(Duration.ofSeconds(20))
                        .build());
```

The following uses `WorkflowImplementationOptions`.

```java
WorkflowImplementationOptions options =
            WorkflowImplementationOptions.newBuilder()
                    .setActivityOptions(
                            ImmutableMap.of(
                                    "GetCustomerGreeting",
                                    // Set Activity Execution timeout
                                    ActivityOptions.newBuilder()
                                        .setScheduleToCloseTimeout(Duration.ofSeconds(5))
                                        // .setStartToCloseTimeout(Duration.ofSeconds(2))
                                        // .setScheduleToStartTimeout(Duration.ofSeconds(5))
                                        .build()))
                    .build();
```

:::note

If you define options per-Activity Type options with `WorkflowImplementationOptions.setActivityOptions()`, setting them again specifically with `ActivityStub` in a Workflow will override this setting.

:::

### How to set an Activity Retry Policy {#activity-retries}

A Retry Policy works in cooperation with the timeouts to provide fine controls to optimize the execution experience.

Activity Executions are automatically associated with a default [Retry Policy](/retry-policies#) <span id="i-d051bf7b-7059-496b-9974-01d3ea245a3c" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-d051bf7b-7059-496b-9974-01d3ea245a3c" class="preview-modal"><div class="modal-header"><div id="x-d051bf7b-7059-496b-9974-01d3ea245a3c" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/retry-policies#">/retry-policies#</a></div><div class="preview-modal-title">What is a Retry Policy?</div><div class="preview-modal-description">A Retry Policy is a collection of attributes that instructs the Temporal Server how to retry a failure of a Workflow Execution or an Activity Task Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> if a custom one is not provided.

To set a Retry Policy, known as the [Retry Options](/retry-policies#) <span id="i-16f90e58-90ea-4563-92cf-3f065aaafd0f" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-16f90e58-90ea-4563-92cf-3f065aaafd0f" class="preview-modal"><div class="modal-header"><div id="x-16f90e58-90ea-4563-92cf-3f065aaafd0f" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/retry-policies#">/retry-policies#</a></div><div class="preview-modal-title">What is a Retry Policy?</div><div class="preview-modal-description">A Retry Policy is a collection of attributes that instructs the Temporal Server how to retry a failure of a Workflow Execution or an Activity Task Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> in Java, use [`ActivityOptions.newBuilder.setRetryOptions()`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/activity/ActivityOptions.Builder.html).

- Type: `RetryOptions`
- Default: Server-defined Activity Retry policy.

- With `ActivityStub`

  ```java
  private final ActivityOptions options =
      ActivityOptions.newBuilder()
          // note that either StartToCloseTimeout or ScheduleToCloseTimeout are
          // required when setting Activity options.
          .setStartToCloseTimeout(Duration.ofSeconds(5))
          .setRetryOptions(
              RetryOptions.newBuilder()
                  .setInitialInterval(Duration.ofSeconds(1))
                  .setMaximumInterval(Duration.ofSeconds(10))
                  .build())
          .build();
  ```

- With `WorkflowImplementationOptions`

  ```java
  WorkflowImplementationOptions options =
          WorkflowImplementationOptions.newBuilder()
                 .setActivityOptions(
                      ImmutableMap.of(
                          "EmailCustomerGreeting",
                          ActivityOptions.newBuilder()
                                // note that either StartToCloseTimeout or ScheduleToCloseTimeout are
                                // required when setting Activity options.
                                .setStartToCloseTimeout(Duration.ofSeconds(5))
                                .setRetryOptions(
                                      RetryOptions.newBuilder()
                                          .setDoNotRetry(NullPointerException.class.getName())
                                          .build())
                                .build()))
                .build();
  ```

## How to Heartbeat an Activity {#activity-heartbeats}

An [Activity Heartbeat](/activities#activity-heartbeat) <span id="i-0f5b7352-4684-47af-93b3-e18cc8dbc7b3" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-0f5b7352-4684-47af-93b3-e18cc8dbc7b3" class="preview-modal"><div class="modal-header"><div id="x-0f5b7352-4684-47af-93b3-e18cc8dbc7b3" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#activity-heartbeat">/activities#activity-heartbeat</a></div><div class="preview-modal-title">What is an Activity Heartbeat?</div><div class="preview-modal-description">An Activity Heartbeat is a ping from the Worker that is executing the Activity to the Temporal Cluster. Each ping informs the Temporal Cluster that the Activity Execution is making progress and the Worker has not crashed.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> is a ping from the [Worker Process](/workers#worker-process) <span id="i-f01f14b1-1fdb-44b2-96a4-5b85d7a7449e" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-f01f14b1-1fdb-44b2-96a4-5b85d7a7449e" class="preview-modal"><div class="modal-header"><div id="x-f01f14b1-1fdb-44b2-96a4-5b85d7a7449e" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workers#worker-process">/workers#worker-process</a></div><div class="preview-modal-title">What is a Worker Process?</div><div class="preview-modal-description">A Worker Process is responsible for polling a Task Queue, dequeueing a Task, executing your code in response to a Task, and responding to the Temporal Server with the results.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> that is executing the Activity to the [Temporal Cluster](/clusters#) <span id="i-4fe98abf-2614-42a8-adef-4450bbe2d328" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-4fe98abf-2614-42a8-adef-4450bbe2d328" class="preview-modal"><div class="modal-header"><div id="x-4fe98abf-2614-42a8-adef-4450bbe2d328" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/clusters#">/clusters#</a></div><div class="preview-modal-title">What is a Temporal Cluster?</div><div class="preview-modal-description">A Temporal Cluster is a Temporal Server paired with Persistence and Visibility stores.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>.
Each Heartbeat informs the Temporal Cluster that the [Activity Execution](/activities#activity-execution) <span id="i-94460e89-6f3e-4f8b-aaed-c7aeb995c308" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-94460e89-6f3e-4f8b-aaed-c7aeb995c308" class="preview-modal"><div class="modal-header"><div id="x-94460e89-6f3e-4f8b-aaed-c7aeb995c308" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#activity-execution">/activities#activity-execution</a></div><div class="preview-modal-title">What is an Activity Execution?</div><div class="preview-modal-description">An Activity Execution is the full chain of Activity Task Executions.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> is making progress and the Worker has not crashed.
If the Cluster does not receive a Heartbeat within a [Heartbeat Timeout](/activities#heartbeat-timeout) <span id="i-61c6026a-3605-4012-ba8a-f5f7789b5870" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-61c6026a-3605-4012-ba8a-f5f7789b5870" class="preview-modal"><div class="modal-header"><div id="x-61c6026a-3605-4012-ba8a-f5f7789b5870" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#heartbeat-timeout">/activities#heartbeat-timeout</a></div><div class="preview-modal-title">What is a Heartbeat Timeout?</div><div class="preview-modal-description">A Heartbeat Timeout is the maximum time between Activity Heartbeats.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div> time period, the Activity will be considered failed and another [Activity Task Execution](/workers#activity-task-execution) <span id="i-c7b968d8-1428-4edf-901a-7271f60b4228" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-c7b968d8-1428-4edf-901a-7271f60b4228" class="preview-modal"><div class="modal-header"><div id="x-c7b968d8-1428-4edf-901a-7271f60b4228" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workers#activity-task-execution">/workers#activity-task-execution</a></div><div class="preview-modal-title">What is an Activity Task Execution?</div><div class="preview-modal-description">An Activity Task Execution occurs when a Worker uses the context provided from the Activity Task and executes the Activity Definition.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> may be scheduled according to the Retry Policy.

Heartbeats may not always be sent to the Clusterâ€”they may be [throttled](/activities#throttling) <span id="i-941e0e71-fe71-4ce1-a46d-510d0b41c02a" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-941e0e71-fe71-4ce1-a46d-510d0b41c02a" class="preview-modal"><div class="modal-header"><div id="x-941e0e71-fe71-4ce1-a46d-510d0b41c02a" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#throttling">/activities#throttling</a></div><div class="preview-modal-title">What is an Activity Heartbeat?</div><div class="preview-modal-description">An Activity Heartbeat is a ping from the Worker that is executing the Activity to the Temporal Cluster. Each ping informs the Temporal Cluster that the Activity Execution is making progress and the Worker has not crashed.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> by the Worker.

Activity Cancellations are delivered to Activities from the Cluster when they Heartbeat. Activities that don't Heartbeat can't receive a Cancellation.
Heartbeat throttling may lead to Cancellation getting delivered later than expected.

Heartbeats can contain a `details` field describing the Activity's current progress.
If an Activity gets retried, the Activity can access the `details` from the last Heartbeat that was sent to the Cluster.

To Heartbeat an Activity Execution in Java, use the `Activity.getExecutionContext().heartbeat()` Class method.

```java
public class YourActivityDefinitionImpl implements YourActivityDefinition {

  @Override
  public String yourActivityMethod(YourActivityMethodParam param) {
    // ...
    Activity.getExecutionContext().heartbeat(details);
    // ...
  }
  // ...
}
```

The method takes an optional argument, the `details` variable above that represents latest progress of the Activity Execution.
This method can take a variety of types such as an exception object, custom object, or string.

If the Activity Execution times out, the last Heartbeat `details` are included in the thrown `ActivityTimeoutException`, which can be caught by the calling Workflow.
The Workflow can then use the `details` information to pass to the next Activity invocation if needed.

In the case of Activity retries, the last Heartbeat's `details` are available and can be extracted from the last failed attempt by using `Activity.getExecutionContext().getHeartbeatDetails(Class<V> detailsClass)`

#### How to set a Heartbeat Timeout {#heartbeat-timeout}

A [Heartbeat Timeout](/activities#heartbeat-timeout) <span id="i-5ea2654c-1eb4-4a38-9443-9895bd5aeafd" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-5ea2654c-1eb4-4a38-9443-9895bd5aeafd" class="preview-modal"><div class="modal-header"><div id="x-5ea2654c-1eb4-4a38-9443-9895bd5aeafd" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#heartbeat-timeout">/activities#heartbeat-timeout</a></div><div class="preview-modal-title">What is a Heartbeat Timeout?</div><div class="preview-modal-description">A Heartbeat Timeout is the maximum time between Activity Heartbeats.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div> works in conjunction with [Activity Heartbeats](/activities#activity-heartbeat) <span id="i-9741bb78-a4f2-4d24-a713-06cdcb2edfc0" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-9741bb78-a4f2-4d24-a713-06cdcb2edfc0" class="preview-modal"><div class="modal-header"><div id="x-9741bb78-a4f2-4d24-a713-06cdcb2edfc0" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#activity-heartbeat">/activities#activity-heartbeat</a></div><div class="preview-modal-title">What is an Activity Heartbeat?</div><div class="preview-modal-description">An Activity Heartbeat is a ping from the Worker that is executing the Activity to the Temporal Cluster. Each ping informs the Temporal Cluster that the Activity Execution is making progress and the Worker has not crashed.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>.

To set a [Heartbeat Timeout](/activities#heartbeat-timeout) <span id="i-4f3a96b8-62d4-481b-9b3e-fe3449860aac" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-4f3a96b8-62d4-481b-9b3e-fe3449860aac" class="preview-modal"><div class="modal-header"><div id="x-4f3a96b8-62d4-481b-9b3e-fe3449860aac" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#heartbeat-timeout">/activities#heartbeat-timeout</a></div><div class="preview-modal-title">What is a Heartbeat Timeout?</div><div class="preview-modal-description">A Heartbeat Timeout is the maximum time between Activity Heartbeats.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/timeouts">timeouts</a></div></div>, use [`ActivityOptions.newBuilder.setHeartbeatTimeout`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/activity/ActivityOptions.Builder.html).

- Type: `Duration`
- Default: None

You can set Activity Options using an `ActivityStub` within a Workflow implementation, or per-Activity using `WorkflowImplementationOptions` within a Worker.
Note that if you define options per-Activity Type options with `WorkflowImplementationOptions.setActivityOptions()`, setting them again specifically with `ActivityStub` in a Workflow will override this setting.

- With `ActivityStub`

  ```java
  private final GreetingActivities activities =
      Workflow.newActivityStub(
          GreetingActivities.class,
          ActivityOptions.newBuilder()
              // note that either StartToCloseTimeout or ScheduleToCloseTimeout are
              // required when setting Activity options.
              .setStartToCloseTimeout(Duration.ofSeconds(5))
              .setHeartbeatTimeout(Duration.ofSeconds(2))
              .build());
  ```

- With `WorkflowImplementationOptions`

  ```java
  WorkflowImplementationOptions options =
              WorkflowImplementationOptions.newBuilder()
                      .setActivityOptions(
                              ImmutableMap.of(
                                "EmailCustomerGreeting",
                                      ActivityOptions.newBuilder()
                                          // note that either StartToCloseTimeout or ScheduleToCloseTimeout are
                                          // required when setting Activity options.
                                            .setStartToCloseTimeout(Duration.ofSeconds(5))
                                            .setHeartbeatTimeout(Duration.ofSeconds(2))
                                            .build()))
                      .build();
  ```

## How to asynchronously complete an Activity {#asynchronous-activity-completion}

[Asynchronous Activity Completion](/activities#asynchronous-activity-completion) <span id="i-3768d5de-d8c9-4785-bda5-2227e9ddbdb1" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-3768d5de-d8c9-4785-bda5-2227e9ddbdb1" class="preview-modal"><div class="modal-header"><div id="x-3768d5de-d8c9-4785-bda5-2227e9ddbdb1" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#asynchronous-activity-completion">/activities#asynchronous-activity-completion</a></div><div class="preview-modal-title">What is Asynchronous Activity Completion?</div><div class="preview-modal-description">Asynchronous Activity Completion occurs when an external system provides the final result of a computation, started by an Activity, to the Temporal System.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> enables the Activity Function to return without the Activity Execution completing.

There are three steps to follow:

1. The Activity provides the external system with identifying information needed to complete the Activity Execution.
   Identifying information can be a [Task Token](/activities#task-token) <span id="i-627db807-621a-446b-95ed-4713b9b69972" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-627db807-621a-446b-95ed-4713b9b69972" class="preview-modal"><div class="modal-header"><div id="x-627db807-621a-446b-95ed-4713b9b69972" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/activities#task-token">/activities#task-token</a></div><div class="preview-modal-title">What is a Task Token?</div><div class="preview-modal-description">A Task Token is a unique identifier for an Activity Task Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div>, or a combination of Namespace, Workflow Id, and Activity Id.
2. The Activity Function completes in a way that identifies it as waiting to be completed by an external system.
3. The Temporal Client is used to Heartbeat and complete the Activity.

To complete an Activity asynchronously, set the [`ActivityCompletionClient`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/ActivityCompletionClient.html) interface to the `complete()` method.

```java
    @Override
    public String composeGreeting(String greeting, String name) {

      // Get the activity execution context
      ActivityExecutionContext context = Activity.getExecutionContext();

      // Set a correlation token that can be used to complete the activity asynchronously
      byte[] taskToken = context.getTaskToken();

      /**
       * For the example we will use a {@link java.util.concurrent.ForkJoinPool} to execute our
       * activity. In real-life applications this could be any service. The composeGreetingAsync
       * method is the one that will actually complete workflow action execution.
       */
      ForkJoinPool.commonPool().execute(() -> composeGreetingAsync(taskToken, greeting, name));
      context.doNotCompleteOnReturn();

      // Since we have set doNotCompleteOnReturn(), the workflow action method return value is
      // ignored.
      return "ignored";
    }

    // Method that will complete action execution using the defined ActivityCompletionClient
    private void composeGreetingAsync(byte[] taskToken, String greeting, String name) {
      String result = greeting + " " + name + "!";

      // Complete our workflow activity using ActivityCompletionClient
      completionClient.complete(taskToken, result);
    }
  }
```

Alternatively, set the [`doNotCompleteOnReturn()`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/activity/ActivityExecutionContext.html#doNotCompleteOnReturn()) method during an Activity Execution.

```java
    @Override
    public String composeGreeting(String greeting, String name) {

      // Get the activity execution context
      ActivityExecutionContext context = Activity.getExecutionContext();

      // Set a correlation token that can be used to complete the activity asynchronously
      byte[] taskToken = context.getTaskToken();

      /**
       * For the example we will use a {@link java.util.concurrent.ForkJoinPool} to execute our
       * activity. In real-life applications this could be any service. The composeGreetingAsync
       * method is the one that will actually complete workflow action execution.
       */
      ForkJoinPool.commonPool().execute(() -> composeGreetingAsync(taskToken, greeting, name));
      context.doNotCompleteOnReturn();

      // Since we have set doNotCompleteOnReturn(), the workflow action method return value is
      // ignored.
      return "ignored";
    }
```

When this method is called during an Activity Execution, the Activity Execution does not complete when its method returns.

## How to start a Child Workflow Execution {#child-workflows}

A [Child Workflow Execution](/workflows#child-workflow) <span id="i-a32dcecb-0edd-40f4-9121-3f413ad95d15" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-a32dcecb-0edd-40f4-9121-3f413ad95d15" class="preview-modal"><div class="modal-header"><div id="x-a32dcecb-0edd-40f4-9121-3f413ad95d15" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#child-workflow">/workflows#child-workflow</a></div><div class="preview-modal-title">What is a Child Workflow Execution?</div><div class="preview-modal-description">A Child Workflow Execution is a Workflow Execution that is spawned from within another Workflow.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/child-workflow">child-workflow</a></div></div> is a Workflow Execution that is scheduled from within another Workflow using a Child Workflow API.

When using a Child Workflow API, Child Workflow related Events ([StartChildWorkflowExecutionInitiated](/references/events#startchildworkflowexecutioninitiated) <span id="i-4d79ea2f-0427-4cb3-ba0c-b47b870bae7c" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-4d79ea2f-0427-4cb3-ba0c-b47b870bae7c" class="preview-modal"><div class="modal-header"><div id="x-4d79ea2f-0427-4cb3-ba0c-b47b870bae7c" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#startchildworkflowexecutioninitiated">/references/events#startchildworkflowexecutioninitiated</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div>, [ChildWorkflowExecutionStarted](/references/events#childworkflowexecutionstarted) <span id="i-83509b02-9f69-48fd-8ee3-1fcc6564ab7f" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-83509b02-9f69-48fd-8ee3-1fcc6564ab7f" class="preview-modal"><div class="modal-header"><div id="x-83509b02-9f69-48fd-8ee3-1fcc6564ab7f" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#childworkflowexecutionstarted">/references/events#childworkflowexecutionstarted</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div>, [ChildWorkflowExecutionCompleted](/references/events#childworkflowexecutioncompleted) <span id="i-ca3a9890-2442-4635-bb9b-4147e8b9583c" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-ca3a9890-2442-4635-bb9b-4147e8b9583c" class="preview-modal"><div class="modal-header"><div id="x-ca3a9890-2442-4635-bb9b-4147e8b9583c" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#childworkflowexecutioncompleted">/references/events#childworkflowexecutioncompleted</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div>, etc...) are logged in the Workflow Execution Event History.

Always block progress until the [ChildWorkflowExecutionStarted](/references/events#childworkflowexecutionstarted) <span id="i-f5c3859c-96d7-44bf-8030-4ada96d32f92" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-f5c3859c-96d7-44bf-8030-4ada96d32f92" class="preview-modal"><div class="modal-header"><div id="x-f5c3859c-96d7-44bf-8030-4ada96d32f92" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/references/events#childworkflowexecutionstarted">/references/events#childworkflowexecutionstarted</a></div><div class="preview-modal-title">Events reference</div><div class="preview-modal-description">Events are created by the Temporal Cluster in response to external occurrences and Commands generated by a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/reference">reference</a></div></div> Event is logged to the Event History to ensure the Child Workflow Execution has started.
After that, Child Workflow Executions may be abandoned using the default _Abandon_ [Parent Close Policy](/workflows#parent-close-policy) <span id="i-a9abdae1-a8e1-45c0-950b-ff0d7ddb4a34" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-a9abdae1-a8e1-45c0-950b-ff0d7ddb4a34" class="preview-modal"><div class="modal-header"><div id="x-a9abdae1-a8e1-45c0-950b-ff0d7ddb4a34" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#parent-close-policy">/workflows#parent-close-policy</a></div><div class="preview-modal-title">What is a Parent Close Policy?</div><div class="preview-modal-description">If a Workflow Execution is a Child Workflow Execution, a Parent Close Policy determines what happens to the Workflow Execution if its Parent Workflow Execution changes to a Closed status (Completed, Failed, Timed out).</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/child-workflow-executions">child-workflow-executions</a></div></div> set in the Child Workflow Options.

To be sure that the Child Workflow Execution has started, first call the Child Workflow Execution method on the instance of Child Workflow future, which returns a different future.

Then get the value of an object that acts as a proxy for a result that is initially unknown, which is what waits until the Child Workflow Execution has spawned.

The first call to the Child Workflow stub must always be its Workflow method (method annotated with `@WorkflowMethod`).
Similar to Activities, invoking Child Workflow methods can be made synchronous or asynchronous by using `Async#function` or `Async#procedure`.
The synchronous call blocks until a Child Workflow method completes.
The asynchronous call returns a `Promise` which can be used to wait for the completion of the Child Workflow method, as in the following example:

```java
GreetingChild child = Workflow.newChildWorkflowStub(GreetingChild.class);
Promise<String> greeting = Async.function(child::composeGreeting, "Hello", name);
// ...
greeting.get()
```

To execute an untyped Child Workflow asynchronously, call `executeAsync` on the `ChildWorkflowStub`, as shown in the following example.

```java
//...
ChildWorkflowStub childUntyped =
    Workflow.newUntypedChildWorkflowStub(
        "GreetingChild", // your workflow type
        ChildWorkflowOptions.newBuilder().setWorkflowId("childWorkflow").build());

Promise<String> greeting =
    childUntyped.executeAsync(String.class, String.class, "Hello", name);
String result = greeting.get();
//...
```

The following examples show how to spawn a Child Workflow:

- Spawn a Child Workflow from a Workflow:

  ```java
  // Child Workflow interface
  @WorkflowInterface
  public interface GreetingChild {
  @WorkflowMethod
  String composeGreeting(String greeting, String name);
  }
  // Child Workflow implementation not shown

  // Parent Workflow implementation
  public class GreetingWorkflowImpl implements GreetingWorkflow {

  @Override
  public String getGreeting(String name) {
      GreetingChild child = Workflow.newChildWorkflowStub(GreetingChild.class);

      // This is a blocking call that returns only after child has completed.
      return child.composeGreeting("Hello", name );
  }
  }
  ```

- Spawn two Child Workflows (with the same type) in parallel:

  ```java
  // Parent Workflow implementation
  public class GreetingWorkflowImpl implements GreetingWorkflow {

      @Override
      public String getGreeting(String name) {

          // Workflows are stateful, so a new stub must be created for each new child.
          GreetingChild child1 = Workflow.newChildWorkflowStub(GreetingChild.class);
          Promise<String> greeting1 = Async.function(child1::composeGreeting, "Hello", name);

          // Both children will run concurrently.
          GreetingChild child2 = Workflow.newChildWorkflowStub(GreetingChild.class);
          Promise<String> greeting2 = Async.function(child2::composeGreeting, "Bye", name);

          // Do something else here.
          ...
          return "First: " + greeting1.get() + ", second: " + greeting2.get();
      }
  }
  ```

- Send a Signal to a Child Workflow from the parent:

  ```java
  // Child Workflow interface
  @WorkflowInterface
  public interface GreetingChild {
      @WorkflowMethod
      String composeGreeting(String greeting, String name);

      @SignalMethod
      void updateName(String name);
  }

  // Parent Workflow implementation
  public class GreetingWorkflowImpl implements GreetingWorkflow {

      @Override
      public String getGreeting(String name) {
          GreetingChild child = Workflow.newChildWorkflowStub(GreetingChild.class);
          Promise<String> greeting = Async.function(child::composeGreeting, "Hello", name);
          child.updateName("Temporal");
          return greeting.get();
      }
  }
  ```

- Sending a Query to Child Workflows from within the parent Workflow code is not supported. However, you can send a Query to Child Workflows from Activities using `WorkflowClient`.

Related reads:

- [How to set Child Workflow Options in Java](#child-workflows) <span id="i-4c437e98-95b4-49f8-b5e6-7afcb6cefd38" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-4c437e98-95b4-49f8-b5e6-7afcb6cefd38" class="preview-modal"><div class="modal-header"><div id="x-4c437e98-95b4-49f8-b5e6-7afcb6cefd38" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="#child-workflows">#child-workflows</a></div><div class="preview-modal-title">How to start a Child Workflow Execution</div><div class="preview-modal-description">A Child Workflow Execution is a Workflow Execution that is scheduled from within another Workflow using a Child Workflow API.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/guide-context">guide-context</a></div></div>

- [How to develop a Workflow Definition](/dev-guide/java/foundations#develop-workflows) <span id="i-fba0e62f-edff-4859-9670-cf6ea08a2fad" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-fba0e62f-edff-4859-9670-cf6ea08a2fad" class="preview-modal"><div class="modal-header"><div id="x-fba0e62f-edff-4859-9670-cf6ea08a2fad" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dev-guide/java/foundations#develop-workflows">/dev-guide/java/foundations#develop-workflows</a></div><div class="preview-modal-title">How to develop a Workflow Definition in Java</div><div class="preview-modal-description">In the Temporal Java SDK programming model, a Workflow is a class which implements a Workflow interface.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/java">java</a> <a class="preview-modal-tag" href="/tags/developer-guide">developer-guide</a></div></div>

- Java Workflow reference: <https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/workflow/package-summary.html>

#### How to set a Parent Close Policy {#parent-close-policy}

A [Parent Close Policy](/workflows#parent-close-policy) <span id="i-43028341-a06c-49ff-8a82-6bd5a143dbfb" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-43028341-a06c-49ff-8a82-6bd5a143dbfb" class="preview-modal"><div class="modal-header"><div id="x-43028341-a06c-49ff-8a82-6bd5a143dbfb" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#parent-close-policy">/workflows#parent-close-policy</a></div><div class="preview-modal-title">What is a Parent Close Policy?</div><div class="preview-modal-description">If a Workflow Execution is a Child Workflow Execution, a Parent Close Policy determines what happens to the Workflow Execution if its Parent Workflow Execution changes to a Closed status (Completed, Failed, Timed out).</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/child-workflow-executions">child-workflow-executions</a></div></div> determines what happens to a Child Workflow Execution if its Parent changes to a Closed status (Completed, Failed, or Timed Out).

The default Parent Close Policy option is set to terminate the Child Workflow Execution.

Set [Parent Close Policy](/workflows#parent-close-policy) <span id="i-9c604f63-9707-4293-9656-896f34d7c7c4" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-9c604f63-9707-4293-9656-896f34d7c7c4" class="preview-modal"><div class="modal-header"><div id="x-9c604f63-9707-4293-9656-896f34d7c7c4" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#parent-close-policy">/workflows#parent-close-policy</a></div><div class="preview-modal-title">What is a Parent Close Policy?</div><div class="preview-modal-description">If a Workflow Execution is a Child Workflow Execution, a Parent Close Policy determines what happens to the Workflow Execution if its Parent Workflow Execution changes to a Closed status (Completed, Failed, Timed out).</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/child-workflow-executions">child-workflow-executions</a></div></div> on an instance of `ChildWorkflowOptions` using [`ChildWorkflowOptions.newBuilder().setParentClosePolicy`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/workflow/ChildWorkflowOptions.Builder.html).

- Type: `ChildWorkflowOptions.Builder`
- Default: `PARENT_CLOSE_POLICY_TERMINATE`

```java
 public void parentWorkflow() {
     ChildWorkflowOptions options =
        ChildWorkflowOptions.newBuilder()
            .setParentClosePolicy(ParentClosePolicy.PARENT_CLOSE_POLICY_ABANDON)
            .build();
     MyChildWorkflow child = Workflow.newChildWorkflowStub(MyChildWorkflow.class, options);
     Async.procedure(child::<workflowMethod>, <args>...);
     Promise<WorkflowExecution> childExecution = Workflow.getWorkflowExecution(child);
     // Wait for child to start
     childExecution.get()
}
```

In this example, we are:

1. Setting `ChildWorkflowOptions.ParentClosePolicy` to `ABANDON` when creating a Child Workflow stub.
2. Starting Child Workflow Execution asynchronously using `Async.function` or `Async.procedure`.
3. Calling `Workflow.getWorkflowExecution(â€¦)` on the child stub.
4. Waiting for the `Promise` returned by `getWorkflowExecution` to complete.
   This indicates whether the Child Workflow started successfully (or failed).
5. Completing parent Workflow Execution asynchronously.

Steps 3 and 4 are needed to ensure that a Child Workflow Execution starts before the parent closes.
If the parent initiates a Child Workflow Execution and then completes immediately after, the Child Workflow will never execute.

## How to Continue-As-New {#continue-as-new}

[Continue-As-New](/workflows#continue-as-new) <span id="i-76fce206-300f-446e-b96f-e43e92bac64e" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-76fce206-300f-446e-b96f-e43e92bac64e" class="preview-modal"><div class="modal-header"><div id="x-76fce206-300f-446e-b96f-e43e92bac64e" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#continue-as-new">/workflows#continue-as-new</a></div><div class="preview-modal-title">What is Continue-As-New?</div><div class="preview-modal-description">Continue-As-New is the mechanism by which all relevant state is passed to a new Workflow Execution with a fresh Event History.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/continue-as-new">continue-as-new</a></div></div> enables a Workflow Execution to close successfully and create a new Workflow Execution in a single atomic operation if the number of Events in the Event History is becoming too large.
The Workflow Execution spawned from the use of Continue-As-New has the same Workflow Id, a new Run Id, and a fresh Event History and is passed all the appropriate parameters.

Temporal SDK allows you to use [Continue-As-New](/workflows#continue-as-new) <span id="i-487aca91-4948-499f-b4e7-149064648537" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-487aca91-4948-499f-b4e7-149064648537" class="preview-modal"><div class="modal-header"><div id="x-487aca91-4948-499f-b4e7-149064648537" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#continue-as-new">/workflows#continue-as-new</a></div><div class="preview-modal-title">What is Continue-As-New?</div><div class="preview-modal-description">Continue-As-New is the mechanism by which all relevant state is passed to a new Workflow Execution with a fresh Event History.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a> <a class="preview-modal-tag" href="/tags/continue-as-new">continue-as-new</a></div></div> in various ways.

To continue execution of the same Workflow that is currently running, use:

```java
Workflow.continueAsNew(input1, ...);
```

To continue execution of a currently running Workflow as a completely different Workflow Type, use `Workflow.newContinueAsNewStub()`.
For example, in a Workflow class called `YourWorkflow`, we can create a Workflow stub with a different type, and call its Workflow method to continue execution as that type:

```java
MyOtherWorkflow continueAsNew = Workflow.newContinueAsNewStub(MyOtherWorkflow.class);
coninueAsNew.greet(input);
```

To provide `ContinueAsNewOptions` options in `Workflow.newContinueAsNewStub()` use:

```java
ContinueAsNewOptions options = ContinueAsNewOptions.newBuilder()
        .setTaskQueue("newTaskQueueName")
        .build();

MyOtherWorkflow continueAsNew = Workflow.newContinueAsNewStub(MyOtherWorkflow.class, options);
// ...
continueAsNew.greet(input);
```

Providing these options allows you to continue Workflow Execution as a new Workflow run, with a different Workflow Type, and on a different Task Queue.

Java Workflow reference: <https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/workflow/package-summary.html>

## What is a Timer? {#timers}

A Workflow can set a durable timer for a fixed time period.
In some SDKs, the function is called `sleep()`, and in others, it's called `timer()`.

A Workflow can sleep for months.
Timers are persisted, so even if your Worker or Temporal Cluster is down when the time period completes, as soon as your Worker and Cluster are back up, the `sleep()` call will resolve and your code will continue executing.

Sleeping is a resource-light operation: it does not tie up the process, and you can run millions of Timers off a single Worker.

To set a Timer in Java, use [`sleep()`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/workflow/Workflow.html#sleep) and pass the number of seconds you want to wait before continuing.

```java
sleep(5);
```

## How to set a Cron Schedule in Java {#cron-schedule}

A [Temporal Cron Job](/workflows#temporal-cron-job) <span id="i-f63938f2-5620-413d-b068-a7dbbde67955" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-f63938f2-5620-413d-b068-a7dbbde67955" class="preview-modal"><div class="modal-header"><div id="x-f63938f2-5620-413d-b068-a7dbbde67955" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/workflows#temporal-cron-job">/workflows#temporal-cron-job</a></div><div class="preview-modal-title">What is a Temporal Cron Job?</div><div class="preview-modal-description">A Temporal Cron Job is the series of Workflow Executions that occur when a Cron Schedule is provided in the call to spawn a Workflow Execution.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> is the series of Workflow Executions that occur when a Cron Schedule is provided in the call to spawn a Workflow Execution.

A Cron Schedule is provided as an option when the call to spawn a Workflow Execution is made.

Set the Cron Schedule with the [`WorkflowStub`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowStub.html) instance in the Client code using [`WorkflowOptions.Builder.setCronSchedule`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowOptions.Builder.html).

Setting `setCronSchedule` changes the Workflow Execution into a Temporal Cron Job.
The default timezone for a Cron is UTC.

- Type: `String`
- Default: None

```java
//create Workflow stub for YourWorkflowInterface
YourWorkflowInterface workflow1 =
    YourWorker.yourclient.newWorkflowStub(
        YourWorkflowInterface.class,
        WorkflowOptions.newBuilder()
                .setWorkflowId("YourWF")
                .setTaskQueue(YourWorker.TASK_QUEUE)
                // Set Cron Schedule
                .setCronSchedule("* * * * *")
                .build());
```

For more details, see the [Cron Sample](https://github.com/temporalio/samples-java/blob/main/src/main/java/io/temporal/samples/hello/HelloCron.java)

## Side Effects {#side-effects}

Side Effects are used to execute non-deterministic code, such as generating a UUID or a random number, without compromising deterministic in the Workflow. This is done by storing the non-deterministic results of the Side Effect into the Workflow [Event History](/workflows/#event-history).

A Side Effect does not re-execute during a Replay. Instead, it returns the recorded result from the Workflow Execution Event History.

Side Effects should not fail. An exception that is thrown from the Side Effect causes failure and retry of the current Workflow Task.

An Activity or a Local Activity may also be used instead of a Side effect, as its result is also persisted in Workflow Execution History.

:::note

You shouldnâ€™t modify the Workflow state inside a Side Effect function, because it is not reexecuted during Replay. Side Effect function should be used to return a value.

:::

To use a Side Effect in Java, set the [`sideEffect()`](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/workflow/Workflow.html#sideEffect(java.lang.Class,io.temporal.workflow.Functions.Func)) function in your Workflow Execution and return the non-deterministic code.

```java
int random = Workflow.sideEffect(Integer.class, () -> random.nextInt(100));
if random < 50 {
       ....
} else {
       ....
}
```

Here's another example that uses `sideEffect()`.

```java
// implementation of the @WorkflowMethod
public void execute() {
    int randomInt = Workflow.sideEffect( int.class, () -> {
        Random random = new SecureRandom();
        return random.nextInt();
    });

    String userHome = Workflow.sideEffect(String.class, () -> System.getenv("USER_HOME"));

    if(randomInt % 2 == 0) {
        // ...
    } else {
        // ...
    }
}
```

Java also provides a deterministic method to generate random numbers or random UUIDs.

To generate random numbers in a deterministic method, use [`newRandom()`](https://www.javadoc.io/static/io.temporal/temporal-sdk/latest/io/temporal/workflow/Workflow.html#newRandom())

```java
// implementation of the @WorkflowMethod
public void execute() {
    int randomInt = Workflow.newRandom().nextInt();
    // ...
}
```

To generate a random UUID in a deterministic method, use [`randomUUID()`](https://www.javadoc.io/static/io.temporal/temporal-sdk/latest/io/temporal/workflow/Workflow.html#newRandom()).

```java
// implementation of the @WorkflowMethod
public void execute() {
    String randomUUID = Workflow.randomUUID().toString();
    // ...
}
```

## How to create and manage Namespaces {#namespaces}

You can create, update, deprecate or delete your [Namespaces](/namespaces#) <span id="i-6e4c2a32-1717-4f3a-a8d8-62a1c2706d9a" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-6e4c2a32-1717-4f3a-a8d8-62a1c2706d9a" class="preview-modal"><div class="modal-header"><div id="x-6e4c2a32-1717-4f3a-a8d8-62a1c2706d9a" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/namespaces#">/namespaces#</a></div><div class="preview-modal-title">What is a Namespace?</div><div class="preview-modal-description">A Namespace is a unit of isolation within the Temporal Platform</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> using either tctl or SDK APIs.

Use Namespaces to isolate your Workflow Executions according to your needs.
For example, you can use Namespaces to match the development lifecycle by having separate `dev` and `prod` Namespaces.
You could also use them to ensure Workflow Executions between different teams never communicate - such as ensuring that the `teamA` Namespace never impacts the `teamB` Namespace.

On Temporal Cloud, use the [Temporal Cloud UI](/cloud/account-setup/namespaces#create-a-namespace) <span id="i-add163e4-ad3a-4b58-8af6-f57e7965a4c6" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-add163e4-ad3a-4b58-8af6-f57e7965a4c6" class="preview-modal"><div class="modal-header"><div id="x-add163e4-ad3a-4b58-8af6-f57e7965a4c6" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/cloud/account-setup/namespaces#create-a-namespace">/cloud/account-setup/namespaces#create-a-namespace</a></div><div class="preview-modal-title">How to create a Namespace in Temporal Cloud</div><div class="preview-modal-description">To create a Namespace in Temporal Cloud, use either Temporal Cloud UI or tcld.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/how-to">how-to</a> <a class="preview-modal-tag" href="/tags/temporal cloud">temporal cloud</a> <a class="preview-modal-tag" href="/tags/namespaces">namespaces</a></div></div> to create and manage a Namespace from the UI, or [tcld commands](https://docs.temporal.io/cloud/tcld/namespace/) to manage Namespaces from the command-line interface.

On self-hosted Temporal Cluster, you can register and manage your Namespaces using tctl (recommended) or programmatically using APIs. Note that these APIs and tctl commands will not work with Temporal Cloud.

Use a custom [Authorizer](/security#authorizer-plugin) <span id="i-d6e682df-63dc-45f9-8001-352cc000ddb9" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-d6e682df-63dc-45f9-8001-352cc000ddb9" class="preview-modal"><div class="modal-header"><div id="x-d6e682df-63dc-45f9-8001-352cc000ddb9" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/security#authorizer-plugin">/security#authorizer-plugin</a></div><div class="preview-modal-title">What is an Authorizer Plugin?</div><div class="preview-modal-description">undefined</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a></div></div> on your Frontend Service in the Temporal Cluster to set restrictions on who can create, update, or deprecate Namespaces.

You must register a Namespace with the Temporal Cluster before setting it in the Temporal Client.

### How to register Namespaces {#register-namespace}

Registering a Namespace creates a Namespace on the Temporal Cluster or Temporal Cloud.

On Temporal Cloud, use the [Temporal Cloud UI](/cloud/account-setup/namespaces#create-a-namespace) <span id="i-77438e69-e755-4a1c-b1cd-01b42b1a7851" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-77438e69-e755-4a1c-b1cd-01b42b1a7851" class="preview-modal"><div class="modal-header"><div id="x-77438e69-e755-4a1c-b1cd-01b42b1a7851" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/cloud/account-setup/namespaces#create-a-namespace">/cloud/account-setup/namespaces#create-a-namespace</a></div><div class="preview-modal-title">How to create a Namespace in Temporal Cloud</div><div class="preview-modal-description">To create a Namespace in Temporal Cloud, use either Temporal Cloud UI or tcld.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/how-to">how-to</a> <a class="preview-modal-tag" href="/tags/temporal cloud">temporal cloud</a> <a class="preview-modal-tag" href="/tags/namespaces">namespaces</a></div></div> or [tcld commands](https://docs.temporal.io/cloud/tcld/namespace/) to create Namespaces.

On self-hosted Temporal Cluster, you can register your Namespaces using tctl (recommended) or programmatically using APIs. Note that these APIs and tctl commands will not work with Temporal Cloud.

Use a custom [Authorizer](/security#authorizer-plugin) <span id="i-dc3b269d-4523-4247-868e-2473d2ade8cb" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-dc3b269d-4523-4247-868e-2473d2ade8cb" class="preview-modal"><div class="modal-header"><div id="x-dc3b269d-4523-4247-868e-2473d2ade8cb" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/security#authorizer-plugin">/security#authorizer-plugin</a></div><div class="preview-modal-title">What is an Authorizer Plugin?</div><div class="preview-modal-description">undefined</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a></div></div> on your Frontend Service in the Temporal Cluster to set restrictions on who can create, update, or deprecate Namespaces.

Use the [`RegisterNamespace` API](https://github.com/temporalio/api/blob/f0350f8032ad2f0c60c539b3b61ea37f412f1cf7/temporal/api/workflowservice/v1/service.proto) to register a [Namespace](/namespaces#) <span id="i-adab84db-dcd7-473b-99be-530ed4a0a75d" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-adab84db-dcd7-473b-99be-530ed4a0a75d" class="preview-modal"><div class="modal-header"><div id="x-adab84db-dcd7-473b-99be-530ed4a0a75d" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/namespaces#">/namespaces#</a></div><div class="preview-modal-title">What is a Namespace?</div><div class="preview-modal-description">A Namespace is a unit of isolation within the Temporal Platform</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> and set the [Retention Period](/clusters#retention-period) <span id="i-f1fcf262-1786-4046-858a-e952efda1e63" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-f1fcf262-1786-4046-858a-e952efda1e63" class="preview-modal"><div class="modal-header"><div id="x-f1fcf262-1786-4046-858a-e952efda1e63" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/clusters#retention-period">/clusters#retention-period</a></div><div class="preview-modal-title">What is a Retention Period?</div><div class="preview-modal-description">A Retention Period is the amount of time a Workflow Execution Event History remains in the Cluster's persistence store.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> for the Workflow Execution Event History for the Namespace.

```java
//...
import com.google.protobuf.util.Durations;
import io.temporal.api.workflowservice.v1.RegisterNamespaceRequest;
//...
public static void createNamespace(String name) {
    RegisterNamespaceRequest req = RegisterNamespaceRequest.newBuilder()
            .setNamespace("your-custom-namespace")
            .setWorkflowExecutionRetentionPeriod(Durations.fromDays(3)) // keeps the Workflow Execution
            //Event History for up to 3 days in the Persistence store. Not setting this value will throw an error.
            .build();
    service.blockingStub().registerNamespace(req);
}
//...
```

The Retention Period setting using `WorkflowExecutionRetentionPeriod` is mandatory.
The minimum value you can set for this period is 1 day.

Once registered, set Namespace using `WorkflowClientOptions` within a Workflow Client to run your Workflow Executions within that Namespace.
See [how to set Namespace in a Client in Java](/dev-guide/java/foundations#connect-to-a-dev-cluster) <span id="i-cfa57303-ccb7-40fa-8afe-96d842bab111" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-cfa57303-ccb7-40fa-8afe-96d842bab111" class="preview-modal"><div class="modal-header"><div id="x-cfa57303-ccb7-40fa-8afe-96d842bab111" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dev-guide/java/foundations#connect-to-a-dev-cluster">/dev-guide/java/foundations#connect-to-a-dev-cluster</a></div><div class="preview-modal-title">How to create a Temporal Client in Java</div><div class="preview-modal-description">To initialize a Workflow Client, create an instance of a `WorkflowClient`, create a client-side `WorkflowStub`, and then call a Workflow method (annotated with the `@WorkflowMethod` annotation).</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/java">java</a> <a class="preview-modal-tag" href="/tags/developer-guide">developer-guide</a></div></div> for details.

Note that Namespace registration using this API takes up to 10 seconds to complete.
Ensure that you wait for this registration to complete before starting the Workflow Execution against the Namespace.

To update your Namespace, use the [`UpdateNamespace` API](/dev-guide/java/features/#namespaces) with the `NamespaceClient`.

### How to manage Namespaces {#manage-namespaces}

You can get details for your Namespaces, update Namespace configuration, and deprecate or delete your Namespaces.

On Temporal Cloud, use the [Temporal Cloud UI](/cloud/account-setup/namespaces#create-a-namespace) <span id="i-5f247429-1b39-430c-816b-5b0e3b5e19d0" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-5f247429-1b39-430c-816b-5b0e3b5e19d0" class="preview-modal"><div class="modal-header"><div id="x-5f247429-1b39-430c-816b-5b0e3b5e19d0" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/cloud/account-setup/namespaces#create-a-namespace">/cloud/account-setup/namespaces#create-a-namespace</a></div><div class="preview-modal-title">How to create a Namespace in Temporal Cloud</div><div class="preview-modal-description">To create a Namespace in Temporal Cloud, use either Temporal Cloud UI or tcld.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/how-to">how-to</a> <a class="preview-modal-tag" href="/tags/temporal cloud">temporal cloud</a> <a class="preview-modal-tag" href="/tags/namespaces">namespaces</a></div></div> or [tcld commands](https://docs.temporal.io/cloud/tcld/namespace/) to manage Namespaces.

On self-hosted Temporal Cluster, you can manage your registered Namespaces using tctl (recommended) or programmatically using APIs. Note that these APIs and tctl commands will not work with Temporal Cloud.

Use a custom [Authorizer](/security#authorizer-plugin) <span id="i-e069634c-bafe-46ee-898d-0b78db2784da" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-e069634c-bafe-46ee-898d-0b78db2784da" class="preview-modal"><div class="modal-header"><div id="x-e069634c-bafe-46ee-898d-0b78db2784da" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/security#authorizer-plugin">/security#authorizer-plugin</a></div><div class="preview-modal-title">What is an Authorizer Plugin?</div><div class="preview-modal-description">undefined</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a></div></div> on your Frontend Service in the Temporal Cluster to set restrictions on who can create, update, or deprecate Namespaces.

You must register a Namespace with the Temporal Cluster before setting it in the Temporal Client.

On Temporal Cloud, use the [Temporal Cloud UI](/cloud/account-setup/namespaces#) <span id="i-87c77e4b-a868-43af-9d10-a1073ac65d9e" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-87c77e4b-a868-43af-9d10-a1073ac65d9e" class="preview-modal"><div class="modal-header"><div id="x-87c77e4b-a868-43af-9d10-a1073ac65d9e" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/cloud/account-setup/namespaces#">/cloud/account-setup/namespaces#</a></div><div class="preview-modal-title">How to manage Namespaces in Temporal Cloud</div><div class="preview-modal-description">You can create and manage Namespaces from your Temporal Cloud UI.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/introduction">introduction</a> <a class="preview-modal-tag" href="/tags/temporal cloud">temporal cloud</a> <a class="preview-modal-tag" href="/tags/namespaces">namespaces</a></div></div> or [tcld commands](https://docs.temporal.io/cloud/tcld/namespace/) to manage Namespaces.

On self-hosted Temporal Cluster, you can manage your registered Namespaces using tctl (recommended) or programmatically using APIs. Note that these APIs and tctl commands will not work with Temporal Cloud.

- Update information and configuration for a registered Namespace on your Temporal Cluster:

  - With tctl: [`tctl namespace update`](/tctl-v1/namespace#update)
    Example
  - Use the [`UpdateNamespace` API](https://github.com/temporalio/api/blob/e5cf521c6fdc71c69353f3d2ac5506dd6e827af8/temporal/api/workflowservice/v1/service.proto) to update configuration on a Namespace.
    Example

  ```java
  import io.temporal.api.workflowservice.v1.*;
  //...
  UpdateNamespaceRequest updateNamespaceRequest = UpdateNamespaceRequest.newBuilder()
              .setNamespace("your-namespace-name") //the namespace that you want to update
              .setUpdateInfo(UpdateNamespaceInfo.newBuilder() //has options to update namespace info
                      .setDescription("your updated namespace description") //updates description in the namespace info.
                      .build())
              .setConfig(NamespaceConfig.newBuilder() //has options to update namespace configuration
                      .setWorkflowExecutionRetentionTtl(Durations.fromHours(30)) //updates the retention period for the namespace "your-namespace--name" to 30 hrs.
                      .build())
              .build();
      UpdateNamespaceResponse updateNamespaceResponse = namespaceservice.blockingStub().updateNamespace(updateNamespaceRequest);
  //...
  ```

- Get details for a registered Namespace on your Temporal Cluster:

  - With tctl: [`tctl namespace describe`](/tctl-v1/namespace#describe)
  - Use the [`DescribeNamespace` API](https://github.com/temporalio/api/blob/e5cf521c6fdc71c69353f3d2ac5506dd6e827af8/temporal/api/workflowservice/v1/service.proto) to return information and configuration details for a registered Namespace.
    Example

  ```java
  import io.temporal.api.workflowservice.v1.*;
  //...
  DescribeNamespaceRequest descNamespace = DescribeNamespaceRequest.newBuilder()
              .setNamespace("your-namespace-name") //specify the namespace you want details for
              .build();
      DescribeNamespaceResponse describeNamespaceResponse = namespaceservice.blockingStub().describeNamespace(descNamespace);
      System.out.println("Namespace Description: " + describeNamespaceResponse);
  //...
  ```

- Get details for all registered Namespaces on your Temporal Cluster:

  - With tctl: [`tctl namespace list`](/tctl-v1/namespace#list)
  - Use the [`ListNamespace` API](https://github.com/temporalio/api/blob/e5cf521c6fdc71c69353f3d2ac5506dd6e827af8/temporal/api/workflowservice/v1/service.proto) to return information and configuration details for all registered Namespaces on your Temporal Cluster.
    Example

  ```java
  import io.temporal.api.workflowservice.v1.*;
  //...
  ListNamespacesRequest listNamespaces = ListNamespacesRequest.newBuilder().build();
      ListNamespacesResponse listNamespacesResponse = namespaceservice.blockingStub().listNamespaces(listNamespaces); //lists 1-100 namespaces (1 page) in the active cluster. To list all, set the page size or loop until NextPageToken is nil.
  //...
  ```

- Deprecate a Namespace: The [`DeprecateNamespace` API](https://github.com/temporalio/api/blob/e5cf521c6fdc71c69353f3d2ac5506dd6e827af8/temporal/api/workflowservice/v1/service.proto) updates the state of a registered Namespace to "DEPRECATED". Once a Namespace is deprecated, you cannot start new Workflow Executions on it. All existing and running Workflow Executions on a deprecated Namespace will continue to run.
  Example:

  ```java
  import io.temporal.api.workflowservice.v1.*;
  //...
  DeprecateNamespaceRequest deprecateNamespace = DeprecateNamespaceRequest.newBuilder()
              .setNamespace("your-namespace-name") //specify the namespace that you want to deprecate
              .build();
      DeprecateNamespaceResponse response = namespaceservice.blockingStub().deprecateNamespace(deprecateNamespace);
  //...
  ```

- Delete a Namespace: The [`DeleteNamespace` API](https://github.com/temporalio/api/blob/e5cf521c6fdc71c69353f3d2ac5506dd6e827af8/temporal/api/workflowservice/v1/service.proto) deletes a Namespace. Deleting a Namespace deletes all running and completed Workflow Executions on the Namespace, and removes them from the persistence store and the visibility store.

  Example:

  ```java
  //...
  DeleteNamespaceResponse res =
  OperatorServiceStubs.newServiceStubs(OperatorServiceStubsOptions.newBuilder()
          .setChannel(service.getRawChannel())
          .validateAndBuildWithDefaults())
      .blockingStub()
      .deleteNamespace(DeleteNamespaceRequest.newBuilder().setNamespace("your-namespace-name").build());
  //...
  ```

## How to use custom payload conversion {#custom-payload-conversion}

Temporal SDKs provide a [Payload Converter](/dataconversion#payload-converter) <span id="i-46504ace-1a64-4f9a-9c26-e4f713c35ff2" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-46504ace-1a64-4f9a-9c26-e4f713c35ff2" class="preview-modal"><div class="modal-header"><div id="x-46504ace-1a64-4f9a-9c26-e4f713c35ff2" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dataconversion#payload-converter">/dataconversion#payload-converter</a></div><div class="preview-modal-title">What is a Payload Converter?</div><div class="preview-modal-description">A Payload Converter serializes data, converting objects or values to bytes and back.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> that can be customized to convert a custom data type to [Payload](/dataconversion#payload) <span id="i-42859b8e-0fc2-446f-99cf-61611001687f" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-42859b8e-0fc2-446f-99cf-61611001687f" class="preview-modal"><div class="modal-header"><div id="x-42859b8e-0fc2-446f-99cf-61611001687f" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dataconversion#payload">/dataconversion#payload</a></div><div class="preview-modal-title">What is a Payload?</div><div class="preview-modal-description">A Payload represents binary data such as input and output from Activities and Workflows.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/payloads">payloads</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> and back.

Implementing custom Payload conversion is optional.
It is needed only if the [default Data Converter](/dataconversion#default-data-converter) <span id="i-d4a88fb9-9825-4a07-96a1-5a09eddfa857" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-d4a88fb9-9825-4a07-96a1-5a09eddfa857" class="preview-modal"><div class="modal-header"><div id="x-d4a88fb9-9825-4a07-96a1-5a09eddfa857" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dataconversion#default-data-converter">/dataconversion#default-data-converter</a></div><div class="preview-modal-title">What is a default Data Converter?</div><div class="preview-modal-description">The default Data Converter is used by the Temporal SDK to convert objects into bytes using a series of Payload Converters.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> does not support your custom values.

To support custom Payload conversion, create a [custom Payload Converter](/dataconversion#custom-payload-conversion) <span id="i-7a331fd6-b0cd-4241-af5f-e86008e25d09" class="clickable-i clickable-link-preview">i</span><div id="preview-modal-7a331fd6-b0cd-4241-af5f-e86008e25d09" class="preview-modal"><div class="modal-header"><div id="x-7a331fd6-b0cd-4241-af5f-e86008e25d09" class="clickable-x clickable-link-preview">x</div><b>Link preview:</b>&nbsp;&nbsp<a href="/dataconversion#custom-payload-conversion">/dataconversion#custom-payload-conversion</a></div><div class="preview-modal-title">What is a Payload Converter?</div><div class="preview-modal-description">A Payload Converter serializes data, converting objects or values to bytes and back.</div><div class="preview-modal-tags"><a class="preview-modal-tag" href="/tags/term">term</a> <a class="preview-modal-tag" href="/tags/explanation">explanation</a></div></div> and configure the Data Converter to use it in your Client options.

The order in which your encoding Payload Converters are applied depend on the order given to the Data Converter.
You can set multiple encoding Payload Converters to run your conversions.
When the Data Converter receives a value for conversion, it passes through each Payload Converter in sequence until the converter that handles the data type does the conversion.

Create a custom implementation of a [PayloadConverter](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/common/converter/PayloadConverter.html) interface and use the `withPayloadConverterOverrides` method to implement the custom object conversion with `DefaultDataConverter`.

`PayloadConverter` serializes and deserializes method parameters that need to be sent over the wire.
You can create a custom implementation of `PayloadConverter` for custom formats, as shown in the following example:

```java
/** Payload Converter specific to your custom object */
public class YourCustomPayloadConverter implements PayloadConverter {
 //...
  @Override
  public String getEncodingType() {
    return "json/plain"; // The encoding type determines which default conversion behavior to override.
  }

  @Override
  public Optional<Payload> toData(Object value) throws DataConverterException {
      // Add your convert-to logic here.
  }

  @Override
  public <T> T fromData(Payload content, Class<T> valueClass, Type valueType)
      throws DataConverterException {
    // Add your convert-from logic here.
  }
//...
}
```

You can also use [specific implementation classes](https://www.javadoc.io/static/io.temporal/temporal-sdk/1.18.1/io/temporal/common/converter/package-summary.html) provided in the Java SDK.

For example, to create a custom `JacksonJsonPayloadConverter`, use the following:

```java
//...
private static JacksonJsonPayloadConverter yourCustomJacksonJsonPayloadConverter() {
  ObjectMapper objectMapper = new ObjectMapper();
  // Add your custom logic here.
  return new JacksonJsonPayloadConverter(objectMapper);
}
//...
```

To set your custom Payload Converter, use it with [withPayloadConverterOverrides](https://www.javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/common/converter/DefaultDataConverter.html#withPayloadConverterOverrides(io.temporal.common.converter.PayloadConverter...)) with a new instance of `DefaultDataConverter` in your `WorkflowClient` options that you use in your Worker process and to start your Workflow Executions.

The following example shows how to set a custom `YourCustomPayloadConverter` Payload Converter.

```java
//...
DefaultDataConverter ddc =
        DefaultDataConverter.newDefaultInstance()
            .withPayloadConverterOverrides(new YourCustomPayloadConverter());

    WorkflowClientOptions workflowClientOptions =
        WorkflowClientOptions.newBuilder().setDataConverter(ddc).build();
//...
```

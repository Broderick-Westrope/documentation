---
id: cancellation
title: Workflow Cancellation - Go SDK feature guide
sidebar_label: Cancellation
sidebar_position: 3
description: Check out the cancellation feature APIs in the Temporal Go SDK.
slug: /dev-guide/go/features/cancellation
toc_max_heading_level: 4
keywords:
- activity
- cancellation
- heartbeat
- temporal client api
- workflow
tags:
- activity
- cancellation
- heartbeat
- temporal-client-api
- workflow
---

<!-- THIS FILE IS GENERATED. DO NOT EDIT THIS FILE DIRECTLY -->

The Temporal Go SDK uses an error type to indicate that there is a cancellation request.

It's considered a request because the Workflow and any cancellable Activities must listen for the error to act upon it.
If they're not listening for it, then Cancellation requests get ignored.

To listen for a Cancellation request in your Temporal Application implement the following:

- Add logic to listen for and handle the Cancellation in the Workflow.
- Add Heartbeats to Cancellable Activities.
- Set Heartbeat Timeouts for Cancellable Activities.
- Use the Temporal Client's Cancellation Request API to request Cancellation.

## How to handle a Cancellation in a Workflow in Go {#handle-cancellation-in-workflow}

<!-- DO NOT EDIT THIS FILE DIRECTLY.
THIS FILE IS GENERATED from https://github.com/temporalio/documentation-samples-go/blob/edu-1036.sc.00/features/cancellation/workflow.go. -->

If the Workflow receives a Cancellation Request, but all Activities gracefully handle the Cancellation, and/or no Activities are skipped then the Workflow status will be Complete.
It is completely up to the needs of the business process and your use case which determines whether you want to return the Cancellation error to show a Canceled status or Complete status regardless of whether a Cancellation has propagated to and/or skipped Activities.

<div class="copycode-notice-container"><div class="copycode-notice"><img data-style="copycode-icon" src="/icons/copycode.png" alt="Copy code icon" /> Sample application code information <img id="i-a4544090-b06b-4120-83b1-896a1d814d69" data-event="clickable-copycode-info" data-style="chevron-icon" src="/icons/chevron.png" alt="Chevron icon" /></div><div id="copycode-info-a4544090-b06b-4120-83b1-896a1d814d69" class="copycode-info">The following code sample comes from a working and tested sample application. The code sample might be abridged within the guide to highlight key aspects. Visit the source repository to <a href="https://github.com/temporalio/documentation-samples-go/blob/edu-1036.sc.00/features/cancellation/workflow.go">view the source code</a> in the context of the rest of the application code.</div></div>

```go
// YourWorkflow is a Workflow Definition that shows how it can be canceled.
func YourWorkflow(ctx workflow.Context) error {
// ...
	activityOptions := workflow.ActivityOptions{
// ...
		WaitForCancellation: true,
	}
	defer func() {
		// This logic ensures cleanup only happens if there is a Cancelation error
		if !errors.Is(ctx.Err(), workflow.ErrCanceled) {
			return
		}
		// For the Workflow to execute an Activity after it receives a Cancellation Request
		// It has to get a new disconnected context
		newCtx, _ := workflow.NewDisconnectedContext(ctx)
		// This Activity is only executed if
		err := workflow.ExecuteActivity(newCtx, a.CleanupActivity).Get(ctx, nil)
		if err != nil {
			logger.Error("CleanupActivity failed", "Error", err)
		}
	}()
// ...
	err := workflow.ExecuteActivity(ctx, a.ActivityToBeCanceled).Get(ctx, &result)
// ...
	// This call to execute the Activity is expected to return an error "canceled".
	// And the Activity Execution is skipped.
	err = workflow.ExecuteActivity(ctx, a.ActivityToBeSkipped).Get(ctx, nil)
// ...
	// Return any errors.
	// If a CanceledError is returned, the Workflow changes to a Canceled state.
	return err
}
```

## How to handle a Cancellation in an Activity in Go {#handle-cancellation-in-an-activity}

<!-- DO NOT EDIT THIS FILE DIRECTLY.
THIS FILE IS GENERATED from https://github.com/temporalio/documentation-samples-go/blob/edu-1036.sc.00/features/cancellation/activity.go. -->

<div class="copycode-notice-container"><div class="copycode-notice"><img data-style="copycode-icon" src="/icons/copycode.png" alt="Copy code icon" /> Sample application code information <img id="i-42cc75cb-8bec-4e43-bb1d-e9db573ed46c" data-event="clickable-copycode-info" data-style="chevron-icon" src="/icons/chevron.png" alt="Chevron icon" /></div><div id="copycode-info-42cc75cb-8bec-4e43-bb1d-e9db573ed46c" class="copycode-info">The following code sample comes from a working and tested sample application. The code sample might be abridged within the guide to highlight key aspects. Visit the source repository to <a href="https://github.com/temporalio/documentation-samples-go/blob/edu-1036.sc.00/features/cancellation/activity.go">view the source code</a> in the context of the rest of the application code.</div></div>

```go
// ActivityToBeCanceled is the Activity that will respond to the Cancellation Request
func (a *Activities) ActivityToBeCanceled(ctx context.Context) (string, error) {
// ...
	// A for select statement is a common approach to listening for a Cancellation is an Activity
	for {
		select {
		case <-time.After(1 * time.Second):
			logger.Info("Heartbeating...")
			activity.RecordHeartbeat(ctx, "")
		// Listen for ctx.Done() to know if a Cancellation Request has propagated to the Activity.
		case <-ctx.Done():
			logger.Info("This Activity is canceled!")
			return "I am canceled by Done", nil
		}
	}
}
```

## How to request Cancellation of a Workflow and Activities in Go {#request-cancellation}

<!-- DO NOT EDIT THIS FILE DIRECTLY.
THIS FILE IS GENERATED from https://github.com/temporalio/documentation-samples-go/blob/edu-1036.sc.00/features/cancellation/cancel/main.go. -->

<div class="copycode-notice-container"><div class="copycode-notice"><img data-style="copycode-icon" src="/icons/copycode.png" alt="Copy code icon" /> Sample application code information <img id="i-b4492b92-a2c3-4a53-81e7-6a371a4ad480" data-event="clickable-copycode-info" data-style="chevron-icon" src="/icons/chevron.png" alt="Chevron icon" /></div><div id="copycode-info-b4492b92-a2c3-4a53-81e7-6a371a4ad480" class="copycode-info">The following code sample comes from a working and tested sample application. The code sample might be abridged within the guide to highlight key aspects. Visit the source repository to <a href="https://github.com/temporalio/documentation-samples-go/blob/edu-1036.sc.00/features/cancellation/cancel/main.go">view the source code</a> in the context of the rest of the application code.</div></div>

```go
func main() {
// ...
	// Call the CancelWorkflow API to cancel a Workflow
	// In this call we are relying on the Workflow Id only.
	// But a Run Id can also be supplied to ensure the correct Workflow is Canceled.
	err = temporalClient.CancelWorkflow(context.Background(), cancellation.WorkflowId, "")
	if err != nil {
		log.Fatalln("Unable to cancel Workflow Execution", err)
	}
// ...
}
```
